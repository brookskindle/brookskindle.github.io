
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Source+Sans+Pro:300,400,400i,700" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://brookskindle.github.io/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://brookskindle.github.io/theme/pygments/dracula.min.css">
  <link rel="stylesheet" type="text/css" href="https://brookskindle.github.io/theme/font-awesome/css/font-awesome.min.css">

    <link href="https://brookskindle.github.io/styles/styles.css" rel="stylesheet">





    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#282a36">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#282a36">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#282a36">

<meta name="author" content="Brooks Kindle" />
<meta name="description" content="How often do you get excited when your phone vibrates and an email notification shows up? If you&#39;re like me, not very. Much like how I only seem to receive spam calls on my phone, almost all of the emails I receive on a daily basis are not important to …" />
<meta name="keywords" content="data, python, email, minimalism, visidata">

<meta property="og:site_name" content="Brooks Kindle"/>
<meta property="og:title" content="I analyzed over 3 gigabytes of email (my own)"/>
<meta property="og:description" content="How often do you get excited when your phone vibrates and an email notification shows up? If you&#39;re like me, not very. Much like how I only seem to receive spam calls on my phone, almost all of the emails I receive on a daily basis are not important to …"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://brookskindle.github.io/i-analyzed-over-3-gigabytes-of-email-my-own.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2020-10-02 00:00:00-07:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://brookskindle.github.io/author/brooks-kindle.html">
<meta property="article:section" content="programming"/>
<meta property="article:tag" content="data"/>
<meta property="article:tag" content="python"/>
<meta property="article:tag" content="email"/>
<meta property="article:tag" content="minimalism"/>
<meta property="article:tag" content="visidata"/>
<meta property="og:image" content="/images/profile.jpg">

  <title>Brooks Kindle &ndash; I analyzed over 3 gigabytes of email (my own)</title>

</head>
<body>
  <aside>
    <div>
      <a href="https://brookskindle.github.io">
        <img src="/images/profile.jpg" alt="Brooks Kindle" title="Brooks Kindle">
      </a>
      <h1><a href="https://brookskindle.github.io">Brooks Kindle</a></h1>

<p>software engineer</p>
      <nav>
        <ul class="list">
          <li><a href="https://brookskindle.github.io/pages/about.html#about">About</a></li>
          <li><a href="https://brookskindle.github.io/pages/contact.html#contact">Contact</a></li>

        </ul>
      </nav>

      <ul class="social">
        <li><a class="sc-github" href="https://github.com/brookskindle" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/brookskindle/" target="_blank"><i class="fa fa-linkedin"></i></a></li>
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href="https://brookskindle.github.io">    Home
</a>

      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>


    </nav>

<article class="single">
  <header>
      
    <h1 id="i-analyzed-over-3-gigabytes-of-email-my-own">I analyzed over 3 gigabytes of email (my own)</h1>
    <p>
          Posted on Fri 02 October 2020 in <a href="https://brookskindle.github.io/category/programming.html">programming</a>


    </p>
  </header>


  <div>
    <p>How often do you get excited when your phone vibrates and an email notification
shows up? If you're like me, not very. Much like how I only seem to receive
spam calls on my phone, almost all of the emails I receive on a daily basis are
not important to me. I get emails about sales I don't care about, terms of
service updates for services I forgot I was using, the latest updates on social
media sites that I rarely log in to, and a plethora of other marketing type
emails I have absolutely zero interest in reading.</p>
<p>Most of the time I archive the mail and move on with my day, but recently I
took a sabbatical from email (read: I turned off notifications for the Gmail
app) and was amazed at the amount of clutter that my inbox was filled with upon
return. Some emails were important (luckily, not many time-sensitive ones), but
most held no value to me.</p>
<p><strong>Just many emails do I unconsciously sift through on a daily basis?</strong></p>
<p>It never really goes down, does it? Signing up for things online presents such
a low barrier to entry that hardly a second thought is given to the act if
there's an app, site, or game I want to try out. Perhaps that's the consumer
culture side of me talking. Do you remember the last time you deleted an online
account of yours?</p>
<p><strong>How many sites support the deletion of accounts?</strong></p>
<p>Not enough, I think. Perhaps I should take a cue from my tendency to <a href="/arch-install.md">fresh
install my operating system every six months</a> and start fresh
with a new email address, and maybe one day I will. But it is not today.</p>
<p><strong>Today we will analyze my emails to figure out who the most frequent sender
is.</strong></p>
<p>Google has a convenient interface for accessing all of your user data,
including emails if you use gmail.</p>
<p><img alt="" src="https://brookskindle.github.io/images/google-takeout.png"></p>
<p>After requesting a data export, Google will send an email with a link when the
data is ready to be downloaded.</p>
<p><img alt="" src="https://brookskindle.github.io/images/gmail-download-ready.png"></p>
<p>I chose a gzipped tar file format (<code>.tgz</code>), so I can uncompress it using
<code>gunzip</code> and <code>tar</code>.</p>
<div class="highlight"><pre><span></span>$ gunzip takeout-20200923T060647Z-001.tgz
$ tar -xvf takeout-20200924T022153Z-001.tar
Takeout/Mail/User Settings/Forwarding Addresses.json
Takeout/Mail/User Settings/Blocked Addresses.json
Takeout/Mail/User Settings/Signatures.json
Takeout/Mail/User Settings/Filters.json
Takeout/Mail/All mail Including Spam and Trash.mbox
Takeout/archive_browser.html
$ ls
Takeout
takeout-20200924T022153Z-001.tar
</pre></div>


<p>The only important file in this list is <code>Takeout/Mail/All mail Including
Spam and Trash.mbox</code>. This file is huge - 3.1 gigabytes! Mbox format? I'm not
very familiar with it, but let's see what the format looks like.</p>
<div class="highlight"><pre><span></span><span class="nv">From</span> <span class="mi">23402857298734987239487</span>@<span class="nv">xxx</span> <span class="nv">Sun</span> <span class="nv">Sep</span> <span class="mi">20</span> <span class="mi">00</span>:<span class="mi">38</span>:<span class="mi">32</span> <span class="o">+</span><span class="mi">0000</span> <span class="mi">2020</span>

<span class="nv">X</span><span class="o">-</span><span class="nv">GM</span><span class="o">-</span><span class="nv">THRID</span>: <span class="mi">358234987239487293847</span>

<span class="nv">X</span><span class="o">-</span><span class="nv">Gmail</span><span class="o">-</span><span class="nv">Labels</span>: <span class="nv">Inbox</span>,<span class="nv">Important</span>,<span class="nv">Category</span> <span class="nv">Personal</span>,<span class="nv">Unread</span>

<span class="nv">Delivered</span><span class="o">-</span><span class="nv">To</span>: .............

<span class="nv">Received</span>:

        <span class="nv">Sat</span>, <span class="mi">19</span> <span class="nv">Sep</span> <span class="mi">2020</span> <span class="mi">17</span>:<span class="mi">38</span>:<span class="mi">32</span> <span class="o">-</span><span class="mi">0700</span> <span class="ss">(</span><span class="nv">PDT</span><span class="ss">)</span>

<span class="nv">X</span><span class="o">-</span><span class="nv">Received</span>:

        <span class="nv">Sat</span>, <span class="mi">19</span> <span class="nv">Sep</span> <span class="mi">2020</span> <span class="mi">17</span>:<span class="mi">38</span>:<span class="mi">32</span> <span class="o">-</span><span class="mi">0700</span> <span class="ss">(</span><span class="nv">PDT</span><span class="ss">)</span>

<span class="nv">ARC</span><span class="o">-</span><span class="nv">Seal</span>: <span class="nv">i</span><span class="o">=</span><span class="mi">1</span><span class="c1">; a=rsa-sha256; t=1600562312; cv=none;</span>

<span class="nv">ARC</span><span class="o">-</span><span class="nv">Message</span><span class="o">-</span><span class="nv">Signature</span>: <span class="nv">i</span><span class="o">=</span><span class="mi">1</span><span class="c1">; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;</span>

<span class="nv">ARC</span><span class="o">-</span><span class="nv">Authentication</span><span class="o">-</span><span class="nv">Results</span>: <span class="nv">i</span><span class="o">=</span><span class="mi">1</span><span class="c1">; mx.google.com;</span>

<span class="k">Return</span><span class="o">-</span><span class="nv">Path</span>: <span class="o">&lt;</span><span class="nv">name</span>@<span class="nv">domain</span>.<span class="nv">com</span><span class="o">&gt;</span>

<span class="nv">Received</span>: <span class="nv">from</span> <span class="nv">mail</span><span class="o">-</span><span class="nv">sor</span><span class="o">-</span><span class="nv">f41</span>.<span class="nv">google</span>.<span class="nv">com</span> <span class="ss">(</span><span class="nv">mail</span><span class="o">-</span><span class="nv">sor</span><span class="o">-</span><span class="nv">f41</span>.<span class="nv">google</span>.<span class="nv">com</span>. [<span class="mi">209</span>.<span class="mi">85</span>.<span class="mi">220</span>.<span class="mi">41</span>]<span class="ss">)</span>

<span class="nv">Received</span><span class="o">-</span><span class="nv">SPF</span>: <span class="nv">pass</span> <span class="ss">()</span>

<span class="nv">Authentication</span><span class="o">-</span><span class="nv">Results</span>: <span class="nv">mx</span>.<span class="nv">google</span>.<span class="nv">com</span><span class="c1">;</span>

<span class="nv">DKIM</span><span class="o">-</span><span class="nv">Signature</span>: <span class="nv">v</span><span class="o">=</span><span class="mi">1</span><span class="c1">; a=rsa-sha256; c=relaxed/relaxed;</span>

<span class="nv">X</span><span class="o">-</span><span class="nv">Google</span><span class="o">-</span><span class="nv">DKIM</span><span class="o">-</span><span class="nv">Signature</span>: <span class="nv">v</span><span class="o">=</span><span class="mi">1</span><span class="c1">; a=rsa-sha256; c=relaxed/relaxed;</span>

<span class="nv">X</span><span class="o">-</span><span class="nv">Gm</span><span class="o">-</span><span class="nv">Message</span><span class="o">-</span><span class="nv">State</span>:

<span class="nv">X</span><span class="o">-</span><span class="nv">Google</span><span class="o">-</span><span class="nv">Smtp</span><span class="o">-</span><span class="nv">Source</span>:

<span class="nv">X</span><span class="o">-</span><span class="nv">Received</span>:

 <span class="nv">Sat</span>, <span class="mi">19</span> <span class="nv">Sep</span> <span class="mi">2020</span> <span class="mi">17</span>:<span class="mi">38</span>:<span class="mi">31</span> <span class="o">-</span><span class="mi">0700</span> <span class="ss">(</span><span class="nv">PDT</span><span class="ss">)</span>

<span class="nv">MIME</span><span class="o">-</span><span class="nv">Version</span>: <span class="mi">1</span>.<span class="mi">0</span>

<span class="nv">From</span>: <span class="nv">firstname</span> <span class="nv">lastname</span> <span class="o">&lt;</span><span class="nv">name</span>@<span class="nv">address</span>.<span class="nv">com</span><span class="o">&gt;</span>

<span class="nv">Date</span>: <span class="nv">Sat</span>, <span class="mi">19</span> <span class="nv">Sep</span> <span class="mi">2020</span> <span class="mi">17</span>:<span class="mi">38</span>:<span class="mi">17</span> <span class="o">-</span><span class="mi">0700</span>

<span class="nv">Message</span><span class="o">-</span><span class="nv">ID</span>: <span class="o">&lt;&gt;</span>

<span class="nv">Subject</span>: ......

<span class="nv">To</span>: .....

<span class="nv">Content</span><span class="o">-</span><span class="nv">Type</span>: <span class="nv">multipart</span><span class="o">/</span><span class="nv">alternative</span><span class="c1">;</span>

<span class="nv">Content</span><span class="o">-</span><span class="nv">Type</span>: <span class="nv">text</span><span class="o">/</span><span class="nv">plain</span><span class="c1">; charset=&quot;UTF-8&quot;</span>



<span class="o">&lt;</span><span class="nv">content</span><span class="o">&gt;</span>
</pre></div>


<p>For the most part it looks like plain text with <code>Name:</code> type headers. Luckily,
python has an mbox library in the stdlib module <code>mailbox</code>, so I don't need to
make my own parser for it. Of these fields, I'm really only interested in a
select few.</p>
<p>This is the script I wrote to parse my mbox file and create a csv of the
interesting fields</p>
<div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">mailbox</span>
<span class="kn">import</span> <span class="nn">csv</span>

<span class="c1"># pip install python-dateutil</span>
<span class="kn">from</span> <span class="nn">dateutil.parser</span> <span class="kn">import</span> <span class="n">parse</span>

<span class="n">inbox</span> <span class="o">=</span> <span class="n">mailbox</span><span class="o">.</span><span class="n">mbox</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>

<span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;X-Gmail-Labels&quot;</span><span class="p">,</span> <span class="s2">&quot;From&quot;</span><span class="p">,</span> <span class="s2">&quot;Date&quot;</span><span class="p">,</span> <span class="s2">&quot;To&quot;</span><span class="p">,</span> <span class="s2">&quot;Subject&quot;</span><span class="p">]</span>
<span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>

<span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">inbox</span><span class="p">:</span>
    <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">msg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">header</span><span class="p">)</span> <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>  <span class="c1"># Date</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</pre></div>


<p>Short and sweet, it accepts a filename as the first command line argument, and
prints csv lines to stdout. There are a couple of checks and type conversions I
included because as I was analyzing the file, I noticed a couple of things</p>
<ul>
<li>not every email has a date</li>
<li>not all dates have the same format</li>
</ul>
<p>Kind of strange, but nothing we can't work around. For now, let's get this data
into a usable form.</p>
<div class="highlight"><pre><span></span><span class="gp">$</span> checkmail.py All<span class="se">\ </span>mail<span class="se">\ </span>Including<span class="se">\ </span>Spam<span class="se">\ </span>and<span class="se">\ </span>Trash.mbox &gt; mail.csv
</pre></div>


<p>Normally at this point I would use pandas to load the csv file into a DataFrame
and analyze it, but I've enjoyed using
<a href="https://github.com/saulpw/visidata">visidata</a>, a general purpose spreadsheet
tool built for the command line. It allows interactive searching, filtering,
and aggregations on the data in question. With it, I was able to easily
determine the most frequent sender.</p>
<div class="highlight"><pre><span></span><span class="gp">$</span> vd mail.csv
</pre></div>


<p>To keep things practical, I restricted the search to the past two years instead
of for all time. For privacy reasons, I will not share most of the results, but
here are some of the interesting ones.</p>
<div class="highlight"><pre><span></span><span class="k">domain</span>               <span class="k">count</span>   <span class="n">percent</span>    <span class="n">histogram</span>
<span class="n">linkedin</span><span class="p">.</span><span class="n">com</span>         <span class="mi">442</span>     <span class="mi">14</span><span class="p">.</span><span class="mi">21</span>      <span class="o">**************************************************</span>
<span class="n">google</span><span class="p">.</span><span class="n">com</span>           <span class="mi">225</span>     <span class="mi">7</span><span class="p">.</span><span class="mi">23</span>       <span class="o">*************************</span>
<span class="n">mint</span><span class="p">.</span><span class="n">com</span>             <span class="mi">131</span>     <span class="mi">4</span><span class="p">.</span><span class="mi">21</span>       <span class="o">**************</span>
<span class="n">pagerduty</span><span class="p">.</span><span class="n">com</span>        <span class="mi">95</span>      <span class="mi">3</span><span class="p">.</span><span class="mi">05</span>       <span class="o">**********</span>
<span class="n">gmail</span><span class="p">.</span><span class="n">com</span>            <span class="mi">91</span>      <span class="mi">2</span><span class="p">.</span><span class="mi">93</span>       <span class="o">**********</span>
<span class="n">github</span><span class="p">.</span><span class="n">com</span>           <span class="mi">88</span>      <span class="mi">2</span><span class="p">.</span><span class="mi">83</span>       <span class="o">*********</span>
<span class="n">indiehackers</span><span class="p">.</span><span class="n">com</span>     <span class="mi">39</span>      <span class="mi">1</span><span class="p">.</span><span class="mi">25</span>       <span class="o">****</span>
<span class="n">amazon</span><span class="p">.</span><span class="n">com</span>           <span class="mi">36</span>      <span class="mi">1</span><span class="p">.</span><span class="mi">16</span>       <span class="o">****</span>
<span class="n">steampowered</span><span class="p">.</span><span class="n">com</span>     <span class="mi">32</span>      <span class="mi">1</span><span class="p">.</span><span class="mi">03</span>       <span class="o">***</span>
</pre></div>


<p>Hold on. LinkedIn accounts for fourteen percent? I'm barely active on that
site, yet it comprises the lion's share of email I receive.</p>
<p>There's not much I can do about PagerDuty emails, because those are work alerts
and I want to get them. Same with GitHub. It's not work, but I do want to know
when someone responds to a thread that I posted on, or creates an issue in one
of my repositories.</p>
<hr>
<p>And that's all. Armed this knowledge, I was able to modify my email
notification preferences on a lot of the email-happy sites. Only time will tell
how successful it is.</p>
<p>This project was one part research to figure out how to reduce email clutter,
and another part data exploration just for the fun of it. I didn't showcase
much of <code>visidata</code>, because it's an interactive tool and it would be hard to
demo it with this dataset, given how much sensitive information there is, but
if you enjoy working with data and like using the command line, the <a href="https://www.youtube.com/watch?v=N1CBDTgGtOU&amp;list=PLxu7QdBkC7drrAGfYzatPGVHIpv4Et46W">lightning
demo</a>
video will blow your socks off.</p>
<p>Until next time.</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://brookskindle.github.io/tag/data.html">data</a>
      <a href="https://brookskindle.github.io/tag/python.html">python</a>
      <a href="https://brookskindle.github.io/tag/email.html">email</a>
      <a href="https://brookskindle.github.io/tag/minimalism.html">minimalism</a>
      <a href="https://brookskindle.github.io/tag/visidata.html">visidata</a>
    </p>
  </div>





</article>

    <footer>
<p>&copy;  </p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Brooks Kindle ",
  "url" : "https://brookskindle.github.io",
  "image": "/images/profile.jpg",
  "description": "None"
}
</script>

</body>
</html>